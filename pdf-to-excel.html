<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ============== BASIC META TAGS ============== -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Free PDF to Excel Converter | Convert PDF to XLSX Online</title>
    <meta name="description" content="Convert PDF files to editable Excel spreadsheets online for free. Our tool accurately extracts tables and text from your PDF and converts them into XLSX format. Secure and private.">
    <meta name="keywords" content="pdf to excel, pdf to xlsx, convert pdf to excel, free pdf converter, pdf table to excel, extract table from pdf, online pdf to excel">
    
    <!-- ============== SEO & SOCIAL META TAGS ============== -->
    <link rel="canonical" href="https://yourwebsite.com/pdf-to-excel.html">
    <link rel="icon" href="Favicon.png" type="image/x-icon">
    <meta property="og:title" content="Free Online PDF to Excel Converter">
    <meta property="og:description" content="Easily convert your PDF tables and data into editable Excel files (XLSX). Fast, free, and works securely in your browser.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourwebsite.com/pdf-to-excel.html">
    <meta property="og:image" content="https://yourwebsite.com/images/pdf-to-excel-og.png">

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- ============== STYLES & FONTS ============== -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007BFF;
            --background-color: #f4faff;
            --card-background: #ffffff;
            --text-color: #333;
            --heading-color: #0056b3;
            --border-color: #ddd;
            --shadow-color: rgba(0, 123, 255, 0.1);
            --success-color: #28a745;
            --error-color: #dc3545;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', Arial, sans-serif;
            background: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .page-header {
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .brand-name { font-size: 1.8em; font-weight: 700; }
        .brand-part-1 { color: var(--primary-color); }
        .brand-part-2 { color: var(--text-color); }
        .back-button {
            text-decoration: none;
            background-color: #e9ecef;
            color: var(--text-color);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            transition: background-color 0.3s;
            border: 1px solid var(--border-color);
        }
        .back-button:hover { background-color: #dee2e6; }
        
        .main-container { width: 100%; max-width: 900px; }
        .content-section, .tool-container, footer {
            background-color: var(--card-background);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 8px 25px var(--shadow-color);
            margin-bottom: 30px;
        }
        h1, h2 { color: var(--heading-color); margin-bottom: 15px; text-align: center; }
        h1 { font-size: 2em; }
        h2 { font-size: 1.6em; }
        h3 { margin-top: 20px; margin-bottom: 10px; }
        p, li { line-height: 1.7; }
        ul { margin-left: 20px; }

        .tool-container { text-align: center; }
        .upload-area {
            border: 3px dashed var(--border-color);
            border-radius: 10px;
            padding: 30px;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .upload-area.dragover { background-color: #e6f2ff; border-color: var(--primary-color); }
        input[type="file"] { display: none; }
        
        .btn {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 16px;
            font-weight: 600;
        }
        .btn:disabled { background-color: #a0a0a0; cursor: not-allowed; }
        
        #status { font-weight: 600; margin-top: 15px; min-height: 24px; }
        
        footer { text-align: center; }
        .footer-container ul { list-style: none; padding: 0; margin: 10px 0; }
        .footer-container li { display: inline; margin: 0 10px; }
        .footer-container a { color: var(--primary-color); text-decoration: none; }
        .footer-bottom { margin-top: 15px; font-size: 0.9em; color: #888; }
    </style>

    <!-- ============== STRUCTURED DATA (SCHEMA MARKUP) ============== -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Free PDF to Excel Converter",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Any (Web-based)",
      "offers": { "@type": "Offer", "price": "0" },
      "description": "A free, web-based tool to convert PDF files into editable Excel (XLSX) spreadsheets by extracting text and table data."
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "Is it safe to convert my PDF file here?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, it is completely safe. This tool processes your PDF file directly in your web browser. Your file is never uploaded to a server, ensuring your data remains private and secure."
        }
      }, {
        "@type": "Question",
        "name": "How accurate is the table extraction?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Our tool uses an advanced algorithm based on text coordinates to reconstruct tables. For most standard, text-based PDFs with clear table structures, the accuracy is very high. However, complex layouts or scanned PDFs (images) may not convert perfectly."
        }
      }]
    }
    </script>
</head>
<body>
  <header class="page-header">
      <a href="index.html#tools" class="back-button">← Back to Tools</a>
      <div class="brand-name">
          <span class="brand-part-1">Tools</span><span class="brand-part-2">Bucket</span>
      </div>
  </header>

  <main class="main-container">
    <section class="content-section">
        <h1>PDF to Excel Converter</h1>
        <p>Unlock the data in your PDF files by converting them into fully editable Excel spreadsheets (XLSX). Our online converter intelligently extracts text and tables from your PDF, preserving the layout as much as possible. It's ideal for financial statements, reports, and any document where you need to work with the data. The entire conversion is done securely in your browser.</p>
    </section>

    <div class="tool-container">
        <h2>Convert Your PDF to XLSX</h2>
        <div id="uploadArea" class="upload-area">
            <p>Drag & drop your PDF here, or click to select a file.</p>
            <p id="fileName" style="font-weight: bold;"></p>
        </div>
        <input type="file" id="pdfInput" accept="application/pdf">
        
        <button id="convertBtn" class="btn" disabled>Convert to Excel</button>
        
        <div id="status"></div>
    </div>
    
    <section class="content-section">
        <h2>Why Convert PDF to Excel?</h2>
        <ul>
            <li><strong>Data Analysis:</strong> Easily analyze and manipulate data from reports, invoices, and statements in Excel.</li>
            <li><strong>Save Time:</strong> Avoid manual data entry by automatically extracting tables and text.</li>
            <li><strong>Editable Content:</strong> Modify and update information from a PDF in a flexible spreadsheet format.</li>
        </ul>
    </section>

    <footer id="contact">
        <div class="footer-container">
            <h3>Quick Links</h3>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#tools">All Tools</a></li>
                <li><a href="privacy-policy.html">Privacy Policy</a></li>
                <li><a href="terms-&-conditions.html">Terms of Use</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Tools Bucket. All rights reserved.</p>
        </div>
    </footer>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Set workerSrc for pdf.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';

        const pdfInput = document.getElementById('pdfInput');
        const uploadArea = document.getElementById('uploadArea');
        const fileNameEl = document.getElementById('fileName');
        const convertBtn = document.getElementById('convertBtn');
        const statusEl = document.getElementById('status');

        let pdfFile = null;

        const setStatus = (message, type) => {
            statusEl.textContent = message;
            statusEl.style.color = type === 'success' ? 'var(--success-color)' : type === 'error' ? 'var(--error-color)' : 'var(--heading-color)';
        };

        const handleFile = (file) => {
            if (!file || file.type !== 'application/pdf') {
                alert('Please select a valid PDF file.');
                return;
            }
            pdfFile = file;
            fileNameEl.textContent = `Selected: ${file.name}`;
            convertBtn.disabled = false;
            setStatus('', 'info');
        };

        uploadArea.addEventListener('click', () => pdfInput.click());
        pdfInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.classList.add('dragover'), false);
        });
        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('dragover'), false);
        });
        uploadArea.addEventListener('drop', (e) => handleFile(e.dataTransfer.files[0]));

        convertBtn.addEventListener('click', async () => {
            if (!pdfFile) return;

            convertBtn.disabled = true;
            setStatus('Reading PDF file...', 'info');

            const reader = new FileReader();
            reader.onload = async (event) => {
                try {
                    const typedArray = new Uint8Array(event.target.result);
                    const pdf = await pdfjsLib.getDocument(typedArray).promise;
                    let worksheetData = [];

                    for (let i = 1; i <= pdf.numPages; i++) {
                        setStatus(`Processing Page ${i} of ${pdf.numPages}...`, 'info');
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        
                        // === ADVANCED TABLE EXTRACTION LOGIC ===
                        const lines = new Map();
                        textContent.items.forEach(item => {
                            const y = Math.round(item.transform[5]); // Y-coordinate
                            if (!lines.has(y)) lines.set(y, []);
                            lines.get(y).push({ x: item.transform[4], text: item.str });
                        });
                        
                        const sortedLines = Array.from(lines.entries()).sort((a, b) => b[0] - a[0]);
                        
                        sortedLines.forEach(([, items]) => {
                            items.sort((a, b) => a.x - b.x);
                            worksheetData.push(items.map(item => item.text));
                        });
                        worksheetData.push([]); // Add a blank row between pages
                    }

                    setStatus('Creating Excel file...', 'info');

                    const ws = XLSX.utils.aoa_to_sheet(worksheetData);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, "PDF Data");

                    const newFileName = pdfFile.name.replace(/\.pdf$/i, '.xlsx');
                    XLSX.writeFile(wb, newFileName);

                    setStatus('Conversion successful! Excel file downloaded.', 'success');
                } catch (err) {
                    console.error(err);
                    setStatus("Error: Could not convert file. Ensure it's a text-based PDF and not an image.", 'error');
                } finally {
                    convertBtn.disabled = false;
                }
            };
            reader.readAsArrayBuffer(pdfFile);
        });
    });
  </script>
</body>
</html>
