<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MJYDCHGD51"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MJYDCHGD51');
</script>
    <!-- ============== BASIC META TAGS ============== -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Free PDF to Excel Converter | Convert PDF to XLSX Online</title>
    <meta name="description" content="Convert PDFs to editable Excel (XLSX) online for free. Accurately extract tables and text. Secure, fast, and private browser-based tool.">
    <meta name="keywords" content="pdf to excel, pdf to xlsx, convert pdf to excel, free pdf converter, pdf table to excel, extract table from pdf, online pdf to excel">
    
    <!-- ============== SEO & SOCIAL META TAGS ============== -->
    <link rel="canonical" href="https://toolsbucket.online/pdf-to-excel.html">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/favicon-64x64.png">
	<link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png">
	<link rel="icon" type="image/png" sizes="512x512" href="/favicon-512x512.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/favicon-192x192.png">
	<meta name="theme-color" content="#ffffff">
    <meta property="og:title" content="Free Online PDF to Excel Converter">
    <meta property="og:description" content="Easily convert your PDF tables and data into editable Excel files (XLSX). Fast, free, and works securely in your browser.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://toolsbucket.online/pdf-to-excel.html">
    <meta property="og:image" content="https://toolsbucket.online/og-image.png">
	<!-- Twitter Card meta tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@ToolsBucket2025"> <!-- Replace with your Twitter username -->
  <meta name="twitter:title" content="ToolsBucket - Free Online Tools">
  <meta name="twitter:description" content="A collection of free, fast, and secure online utilities for PDFs, images, text, and web development.">
  <meta name="twitter:image" content="https://toolsbucket.online/ToolsBucket_banner.jpg"> <!-- Replace with your image URL -->

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- ============== STYLES & FONTS ============== -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007BFF;
            --background-color: #f4faff;
            --card-background: #ffffff;
            --text-color: #333;
            --heading-color: #0056b3;
            --border-color: #ddd;
            --shadow-color: rgba(0, 123, 255, 0.1);
            --success-color: #28a745;
            --error-color: #dc3545;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Poppins', Arial, sans-serif;
            background: var(--background-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .page-header {
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .brand-name { font-size: 1.8em; font-weight: 700; }
        .brand-part-1 { color: var(--primary-color); }
        .brand-part-2 { color: var(--text-color); }
        .back-button {
            text-decoration: none;
            background-color: #e9ecef;
            color: var(--text-color);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            transition: background-color 0.3s;
            border: 1px solid var(--border-color);
        }
        .back-button:hover { background-color: #dee2e6; }
        
        .main-container { width: 100%; max-width: 900px; }
        .content-section, .tool-container, footer, .faq-section {
            background-color: var(--card-background);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 8px 25px var(--shadow-color);
            margin-bottom: 30px;
        }
        h1, h2 { color: var(--heading-color); margin-bottom: 15px; text-align: center; }
        h1 { font-size: 2em; }
        h2 { font-size: 1.6em; }
        h3 { margin-top: 20px; margin-bottom: 10px; }
        p, li { line-height: 1.7; }
        ul { margin-left: 20px; }

        .tool-container { text-align: center; }
        .upload-area {
            border: 3px dashed var(--border-color);
            border-radius: 10px;
            padding: 30px;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .upload-area.dragover { background-color: #e6f2ff; border-color: var(--primary-color); }
        input[type="file"] { display: none; }
        
        .btn {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 16px;
            font-weight: 600;
        }
        .btn:disabled { background-color: #a0a0a0; cursor: not-allowed; }
        
        #status { font-weight: 600; margin-top: 15px; min-height: 24px; }

        .faq-item {
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
        }
        .faq-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .faq-question {
            font-weight: 600;
            cursor: pointer;
            color: var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .faq-question::after {
            content: '+';
            font-size: 1.2em;
            margin-left: 10px;
        }
        .faq-question.active::after {
            content: '-';
        }
        .faq-answer {
            margin-top: 10px;
            padding-left: 15px;
            display: none;
        }
        .faq-answer.active {
            display: block;
        }
        
        footer { text-align: center; }
        .footer-container ul { list-style: none; padding: 0; margin: 10px 0; }
        .footer-container li { display: inline; margin: 0 10px; }
        .footer-container a { color: var(--primary-color); text-decoration: none; }
        .footer-bottom { margin-top: 15px; font-size: 0.9em; color: #888; }
    </style>

    <!-- ============== STRUCTURED DATA (SCHEMA MARKUP) ============== -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Free PDF to Excel Converter",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Any (Web-based)",
      "offers": { "@type": "Offer", "price": "0" },
      "description": "A free, web-based tool to convert PDF files into editable Excel (XLSX) spreadsheets by extracting text and table data."
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "What is the Free PDF to Excel Converter?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Our Free PDF to Excel Converter is an online tool that allows you to transform your static PDF documents into dynamic, editable Microsoft Excel (XLSX) spreadsheets. It intelligently identifies and extracts tabular data, text, and numerical information from your PDF files, restructuring them into a format that can be easily analyzed, edited, and manipulated in Excel."
        }
      }, {
        "@type": "Question",
        "name": "How do I use the PDF to Excel converter?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Using our converter is straightforward: 1. Click the 'Drag & drop your PDF here, or click to select a file' area. 2. Select the PDF file you wish to convert from your computer. 3. Once your file is loaded, click the 'Convert to Excel' button. 4. The tool will process your file and automatically download the converted XLSX spreadsheet to your device. The entire process is quick and happens within your browser."
        }
      }, {
        "@type": "Question",
        "name": "Is my PDF file safe and secure during conversion?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Absolutely. Security and privacy are paramount. Unlike many online converters, our tool performs the entire PDF to Excel conversion process directly within your web browser. This means your PDF file is never uploaded to any external server, ensuring that your sensitive data remains on your device and is not exposed or stored elsewhere."
        }
      }, {
        "@type": "Question",
        "name": "What are the main benefits of converting PDF to Excel?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Converting PDFs to Excel offers numerous advantages: <ul><li><strong>Data Analysis:</strong> Easily analyze and manipulate data from financial reports, invoices, sales figures, and more.</li><li><strong>Time-Saving:</strong> Eliminate the need for tedious manual data entry, automating the extraction of structured data.</li><li><strong>Editable Content:</strong> Transform static PDF content into a flexible, editable spreadsheet format, allowing for quick modifications and updates.</li><li><strong>Improved Workflow:</strong> Integrate PDF data seamlessly into your existing spreadsheets and data analysis tools.</li><li><strong>Accuracy:</strong> Reduce human error associated with re-typing data.</li></ul>"
        }
      }, {
        "@type": "Question",
        "name": "How accurate is the table and data extraction?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Our converter utilizes an advanced algorithm designed to accurately reconstruct tables and extract text based on their spatial coordinates within the PDF. For most standard, text-based PDFs with clear, well-defined table structures, the accuracy is very high, preserving rows and columns effectively. However, complex layouts, heavily stylized documents, or scanned PDFs (which are essentially images of text) may present challenges and might not convert with 100% perfect fidelity."
        }
      }, {
        "@type": "Question",
        "name": "Can I convert scanned PDFs or image-based PDFs?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Currently, our tool is optimized for text-based PDFs. While it may attempt to process image-based PDFs, the accuracy of data extraction for scanned documents is limited because the text is not machine-readable. For optimal results, we recommend using text-selectable PDFs."
        }
      }, {
        "@type": "Question",
        "name": "Are there any file size limits?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Since the conversion happens entirely in your browser, the primary limitation will be your browser's memory and processing power. For very large or complex PDFs with hundreds of pages, the conversion might take longer or could potentially encounter memory issues on older systems. For most standard business documents, you should not experience any issues."
        }
      }, {
        "@type": "Question",
        "name": "Do I need to install any software?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "No, absolutely not! Our PDF to Excel Converter is a completely web-based online tool. You don't need to download or install any software, plugins, or extensions. All you need is a modern web browser and an internet connection to get started."
        }
      }, {
        "@type": "Question",
        "name": "What Excel format does the converter output?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The converter outputs your data in the widely used .xlsx format, which is compatible with all recent versions of Microsoft Excel (2007 and newer), as well as other spreadsheet programs like Google Sheets, LibreOffice Calc, and Apple Numbers."
        }
      }]
    }
    </script>
	<!========Ads Section ===========>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5037596819589415"
     crossorigin="anonymous"></script>
    <!=========Ads Section ===========>
</head>
<body>
  <header class="page-header">
      <a href="index.html#tools" class="back-button">← Back to Tools</a>
      <div class="brand-name">
          <span class="brand-part-1">Tools</span><span class="brand-part-2">Bucket</span>
      </div>
  </header>

  <main class="main-container">
    <section class="content-section">
        <h1>Free Online PDF to Excel Converter: Transform Your Data with Ease</h1>
        <p>
            Welcome to ToolsBucket's premier <strong>Free PDF to Excel Converter</strong> – your ultimate online solution for effortlessly transforming static PDF documents into dynamic, editable Microsoft Excel spreadsheets (XLSX). In today's data-driven world, getting valuable information out of PDF files for analysis, reporting, or further manipulation can be a time-consuming challenge. Our powerful yet user-friendly tool is designed to overcome this by intelligently extracting tables, text, and numerical data from your PDFs, ensuring an accurate and efficient conversion process. Whether you're dealing with financial statements, detailed reports, sales figures, or any document containing structured data, our converter provides a seamless path to make that data actionable within Excel.
        </p>
        <p>
            The core strength of our PDF to Excel converter lies in its advanced algorithm, which meticulously processes your PDF content. Instead of simply converting an image, it identifies the underlying text and table structures, preserving their layout as much as possible. This means you get a ready-to-use XLSX file where columns, rows, and individual data points are accurately mapped, significantly reducing the need for manual cleanup. What truly sets ToolsBucket apart is our unwavering commitment to security and privacy. Unlike many online tools that require you to upload your sensitive documents to a server, our entire conversion process happens directly within your web browser. This client-side processing guarantees that your files never leave your device, offering unparalleled peace of mind regarding your data's confidentiality.
        </p>
    </section>
<!================Ads Section================>
<script type="text/javascript">
	atOptions = {
		'key' : 'ccc0093d01f3c0d6f08625bae6e22475',
		'format' : 'iframe',
		'height' : 90,
		'width' : 728,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/ccc0093d01f3c0d6f08625bae6e22475/invoke.js"></script>
    <!================Ads Section================>
    <div class="tool-container">
        <h2>Convert Your PDF to XLSX Now</h2>
        <div id="uploadArea" class="upload-area">
            <p>Drag & drop your PDF here, or click to select a file.</p>
            <p id="fileName" style="font-weight: bold;"></p>
        </div>
        <input type="file" id="pdfInput" accept="application/pdf">
        
        <button id="convertBtn" class="btn" disabled>Convert to Excel</button>
        
        <div id="status"></div>
    </div>

  <!========Ads Section ===========>
    <script async="async" data-cfasync="false" src="//pl27456121.revenuecpmgate.com/b589d3ed3b615decf33376b5b2d2ab8a/invoke.js"></script>
<div id="container-b589d3ed3b615decf33376b5b2d2ab8a"></div>
    <!=========Ads Section ===========>
      
    <section class="content-section">
        <h2>How to Use Our Free PDF to Excel Converter</h2>
        <p>Converting your PDF to an editable Excel file has never been easier. Our intuitive interface ensures a smooth process from start to finish. Follow these simple steps to transform your documents:</p>
        <ol>
            <li><strong>Select Your PDF File:</strong> You have two convenient options to get your PDF into the converter. You can either click on the "Drag & drop your PDF here, or click to select a file" area, which will open a file browser for you to select your PDF document from your computer. Alternatively, if you prefer a quicker method, simply drag and drop your PDF file directly into this designated upload area.</li>
            <li><strong>Monitor File Selection:</strong> Once your PDF is successfully loaded, its name will appear below the upload area, confirming that the file is ready for conversion. The "Convert to Excel" button will also become active.</li>
            <li><strong>Initiate Conversion:</strong> Click the now-active "Convert to Excel" button. Our tool will begin processing your PDF. You'll see status messages updating you on the progress, such as "Reading PDF file..." and "Processing Page X of Y..." This ensures you're always informed about what's happening.</li>
            <li><strong>Download Your Excel File:</strong> Once the conversion is complete, your newly created XLSX file will automatically download to your computer. The filename will typically be the same as your original PDF, but with an '.xlsx' extension.</li>
        </ol>
        <p>That's it! In just a few clicks, your data is liberated from the PDF format and ready for all your spreadsheet needs. The entire operation is handled efficiently and securely within your browser.</p>
    </section>

    <section class="content-section">
        <h2>Why Choose ToolsBucket's PDF to Excel Converter? Key Benefits</h2>
        <p>Our Free PDF to Excel converter offers a multitude of advantages that make it an indispensable tool for professionals, students, and anyone working with data:</p>
        <ul>
            <li><strong>Unparalleled Data Accuracy:</strong> Leveraging advanced text coordinate-based algorithms, our tool excels at reconstructing tables with high fidelity. It strives to maintain the original layout, columns, and rows, ensuring that your extracted data is as accurate as possible, minimizing the need for post-conversion adjustments.</li>
            <li><strong>Boost Productivity & Save Time:</strong> Say goodbye to tedious, error-prone manual data entry. Our converter automates the extraction process, allowing you to convert complex reports and financial statements in seconds, freeing up valuable time for more critical tasks.</li>
            <li><strong>Complete Data Privacy & Security:</strong> This is our strongest commitment. Your files are processed entirely client-side, within your web browser. This means your sensitive documents are never uploaded to our servers, ensuring absolute privacy and security for your information.</li>
            <li><strong>Fully Editable Excel Output:</strong> Transform static PDF content into a dynamic, flexible, and fully editable XLSX spreadsheet. You can easily sort, filter, analyze, and update information, making your data truly workable.</li>
            <li><strong>Cost-Effective Solution:</strong> Our tool is completely free to use, offering a professional-grade conversion experience without any hidden costs, subscriptions, or limitations on file size (within reasonable browser limits).</li>
            <li><strong>User-Friendly Interface:</strong> Designed with simplicity in mind, our converter is incredibly easy to navigate. No technical expertise is required; just upload your PDF and click convert.</li>
            <li><strong>Universal Accessibility:</strong> Being a web-based tool, it works seamlessly across all operating systems (Windows, macOS, Linux) and popular browsers (Chrome, Firefox, Edge, Safari), without requiring any software installation.</li>
        </ul>
        <p>By using ToolsBucket's PDF to Excel converter, you gain not just a conversion tool, but a reliable partner in your data management workflow, enhancing efficiency, accuracy, and security.</p>
    </section>

    <section class="faq-section">
        <h2>Frequently Asked Questions (FAQs)</h2>
        <div class="faq-item">
            <div class="faq-question">What is the Free PDF to Excel Converter?</div>
            <div class="faq-answer">
                <p>Our Free PDF to Excel Converter is an online tool that allows you to transform your static PDF documents into dynamic, editable Microsoft Excel (XLSX) spreadsheets. It intelligently identifies and extracts tabular data, text, and numerical information from your PDF files, restructuring them into a format that can be easily analyzed, edited, and manipulated in Excel.</p>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">How do I use the PDF to Excel converter?</div>
            <div class="faq-answer">
                <p>Using our converter is straightforward:</p>
                <ol>
                    <li>Click the 'Drag & drop your PDF here, or click to select a file' area.</li>
                    <li>Select the PDF file you wish to convert from your computer.</li>
                    <li>Once your file is loaded, click the 'Convert to Excel' button.</li>
                    <li>The tool will process your file and automatically download the converted XLSX spreadsheet to your device. The entire process is quick and happens within your browser.</li>
                </ol>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">Is my PDF file safe and secure during conversion?</div>
            <div class="faq-answer">
                <p>Absolutely. Security and privacy are paramount. Unlike many online converters, our tool performs the entire PDF to Excel conversion process directly within your web browser. Your file is never uploaded to a server, ensuring your data remains private and secure.</p>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">What are the main benefits of converting PDF to Excel?</div>
            <div class="faq-answer">
                <p>Converting PDFs to Excel offers numerous advantages:</p>
                <ul>
                    <li><strong>Data Analysis:</strong> Easily analyze and manipulate data from financial reports, invoices, sales figures, and more.</li>
                    <li><strong>Time-Saving:</strong> Eliminate the need for tedious manual data entry, automating the extraction of structured data.</li>
                    <li><strong>Editable Content:</strong> Transform static PDF content into a flexible, editable spreadsheet format, allowing for quick modifications and updates.</li>
                    <li><strong>Improved Workflow:</strong> Integrate PDF data seamlessly into your existing spreadsheets and data analysis tools.</li>
                    <li><strong>Accuracy:</strong> Reduce human error associated with re-typing data.</li>
                </ul>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">How accurate is the table and data extraction?</div>
            <div class="faq-answer">
                <p>Our converter utilizes an advanced algorithm designed to accurately reconstruct tables and extract text based on their spatial coordinates within the PDF. For most standard, text-based PDFs with clear, well-defined table structures, the accuracy is very high, preserving rows and columns effectively. However, complex layouts, heavily stylized documents, or scanned PDFs (which are essentially images of text) may present challenges and might not convert with 100% perfect fidelity.</p>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">Can I convert scanned PDFs or image-based PDFs?</div>
            <div class="faq-answer">
                <p>Currently, our tool is optimized for text-based PDFs. While it may attempt to process image-based PDFs, the accuracy of data extraction for scanned documents is limited because the text is not machine-readable. For optimal results, we recommend using text-selectable PDFs.</p>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">Are there any file size limits?</div>
            <div class="faq-answer">
                <p>Since the conversion happens entirely in your browser, the primary limitation will be your browser's memory and processing power. For very large or complex PDFs with hundreds of pages, the conversion might take longer or could potentially encounter memory issues on older systems. For most standard business documents, you should not experience any issues.</p>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">Do I need to install any software?</div>
            <div class="faq-answer">
                <p>No, absolutely not! Our PDF to Excel Converter is a completely web-based online tool. You don't need to download or install any software, plugins, or extensions. All you need is a modern web browser and an internet connection to get started.</p>
            </div>
        </div>
        <div class="faq-item">
            <div class="faq-question">What Excel format does the converter output?</div>
            <div class="faq-answer">
                <p>The converter outputs your data in the widely used .xlsx format, which is compatible with all recent versions of Microsoft Excel (2007 and newer), as well as other spreadsheet programs like Google Sheets, LibreOffice Calc, and Apple Numbers.</p>
            </div>
        </div>
    </section>

	  <!================ Ads Section =============>
<script type="text/javascript">
	atOptions = {
		'key' : 'e25f82d7e66e0898049dce93facd48c7',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/e25f82d7e66e0898049dce93facd48c7/invoke.js"></script>
    <!================Ads Section================>
    <footer id="contact">
        <div class="footer-container">
            <h3>Quick Links</h3>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="index.html#tools">All Tools</a></li>
                <li><a href="privacy-policy.html">Privacy Policy</a></li>
                <li><a href="terms-&-conditions.html">Terms of Use</a></li>
                <li><a href="about.html">About Us</a></li>
            </ul>
        </div>
        <div class="footer-bottom">
            <p>© 2025 ToolsBucket. All rights reserved.</p>
        </div>
    </footer>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // Set workerSrc for pdf.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';

        const pdfInput = document.getElementById('pdfInput');
        const uploadArea = document.getElementById('uploadArea');
        const fileNameEl = document.getElementById('fileName');
        const convertBtn = document.getElementById('convertBtn');
        const statusEl = document.getElementById('status');

        let pdfFile = null;

        const setStatus = (message, type) => {
            statusEl.textContent = message;
            statusEl.style.color = type === 'success' ? 'var(--success-color)' : type === 'error' ? 'var(--error-color)' : 'var(--heading-color)';
        };

        const handleFile = (file) => {
            if (!file || file.type !== 'application/pdf') {
                alert('Please select a valid PDF file.');
                return;
            }
            pdfFile = file;
            fileNameEl.textContent = `Selected: ${file.name}`;
            convertBtn.disabled = false;
            setStatus('', 'info');
        };

        uploadArea.addEventListener('click', () => pdfInput.click());
        pdfInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); }, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.classList.add('dragover'), false);
        });
        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('dragover'), false);
        });
        uploadArea.addEventListener('drop', (e) => handleFile(e.dataTransfer.files[0]));

        convertBtn.addEventListener('click', async () => {
            if (!pdfFile) return;

            convertBtn.disabled = true;
            setStatus('Reading PDF file...', 'info');

            const reader = new FileReader();
            reader.onload = async (event) => {
                try {
                    const typedArray = new Uint8Array(event.target.result);
                    const pdf = await pdfjsLib.getDocument(typedArray).promise;
                    let worksheetData = [];

                    for (let i = 1; i <= pdf.numPages; i++) {
                        setStatus(`Processing Page ${i} of ${pdf.numPages}...`, 'info');
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        
                        // === ADVANCED TABLE EXTRACTION LOGIC ===
                        const lines = new Map();
                        textContent.items.forEach(item => {
                            const y = Math.round(item.transform[5]); // Y-coordinate
                            if (!lines.has(y)) lines.set(y, []);
                            lines.get(y).push({ x: item.transform[4], text: item.str });
                        });
                        
                        const sortedLines = Array.from(lines.entries()).sort((a, b) => b[0] - a[0]);
                        
                        sortedLines.forEach(([, items]) => {
                            items.sort((a, b) => a.x - b.x);
                            worksheetData.push(items.map(item => item.text));
                        });
                        worksheetData.push([]); // Add a blank row between pages
                    }

                    setStatus('Creating Excel file...', 'info');

                    const ws = XLSX.utils.aoa_to_sheet(worksheetData);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, "PDF Data");

                    const newFileName = pdfFile.name.replace(/\.pdf$/i, '.xlsx');
                    XLSX.writeFile(wb, newFileName);

                    setStatus('Conversion successful! Excel file downloaded.', 'success');
                } catch (err) {
                    console.error(err);
                    setStatus("Error: Could not convert file. Ensure it's a text-based PDF and not an image.", 'error');
                } finally {
                    convertBtn.disabled = false;
                }
            };
            reader.readAsArrayBuffer(pdfFile);
        });

        // FAQ accordion functionality
        document.querySelectorAll('.faq-question').forEach(question => {
            question.addEventListener('click', () => {
                const answer = question.nextElementSibling;
                question.classList.toggle('active');
                if (answer.classList.contains('active')) {
                    answer.classList.remove('active');
                } else {
                    answer.classList.add('active');
                }
            });
        });
    });
  </script>
</body>
</html>
